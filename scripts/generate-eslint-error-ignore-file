#!/bin/sh
#
# generates .eslintignore.errorfiles to list the files which have errors in,
# so that they can be ignored in future automated linting.

out=.eslintignore.errorfiles

cd `dirname $0`/..

echo "generating $out"

{
    cat <<EOF
# autogenerated file: run scripts/generate-eslint-error-ignore-file to update.

EOF

    ./node_modules/.bin/eslint -f json src test |
        jq -r '.[] | select((.errorCount + .warningCount) > 0) | .filePath' |
        sed -e 's/.*matrix-react-sdk\///';
} > "$out"
# also append rules from eslintignore file
cat .eslintignore >> $out
